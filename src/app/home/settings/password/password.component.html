<h2 mat-dialog-title>{{'SETTINGS_SECURITY_CHANGE_PASSWORD' | translate}}</h2>
<mat-dialog-content>
  <mat-vertical-stepper #stepper [linear]="true">
    <mat-step [editable]="false">
      <ng-template matStepLabel>{{'SETTINGS_SECURITY_MODAL_CHANGE_PASSWORD_TITLE_START' | translate}}</ng-template>
      <mat-card *ngIf="showOldPasswordIncorrectCard" class="error-mat-card" matRipple>
        <mat-card-content class="last-child">
          {{'SETTINGS_SECURITY_MODAL_CHANGE_PASSWORD_OLD_PASSWORD_INCORRECT' | translate}}
        </mat-card-content>
      </mat-card>

      <form #checkOldPasswordForm="ngForm" (ngSubmit)="checkOldPassword()">
        <mat-form-field class="col-12">
          <input [(ngModel)]="oldPassword" id="oldPassword" matInput name="oldPassword"
                 ngModel placeholder="{{'SETTINGS_SECURITY_MODAL_CHANGE_PASSWORD_OLD_PASSWORD' | translate}}" required
                 type="password"/>
        </mat-form-field>

        <mat-progress-bar *ngIf="showCheckingOldPasswordSpinner" mode="indeterminate"></mat-progress-bar>

        <button *ngIf="!showCheckingOldPasswordSpinner" [disabled]="!checkOldPasswordForm.form.valid"
                mat-button type="submit">
          {{'NEXT' | translate}}
        </button>
      </form>
    </mat-step>

    <mat-step [editable]="false">
      <ng-template
        matStepLabel>{{'SETTINGS_SECURITY_MODAL_CHANGE_PASSWORD_TITLE_NEW_PASSWORD' | translate}}</ng-template>

      <form #changePasswordForm="ngForm" (ngSubmit)="changePassword()">
        <mat-form-field class="col-12">
          <input #passwordModel="ngModel" [(ngModel)]="newPassword" id="newPassword" matInput
                 name="newPassword" ngModel placeholder="{{'SETTINGS_SECURITY_MODAL_CHANGE_PASSWORD_NEW_PASSWORD' | translate}}" required
                 type="password"/>
        </mat-form-field>
        <mat-form-field class="col-12">
          <input #newPasswordRepeatModel="ngModel" [(ngModel)]="newPasswordRepeat" [equalTo]="passwordModel" id="newPassword_repeat"
                 matInput name="newPassword_repeat" ngModel placeholder="{{'SETTINGS_SECURITY_MODAL_CHANGE_PASSWORD_NEW_PASSWORD_REPEAT' | translate}}"
                 type="password"/>
          <mat-error *ngIf="newPasswordRepeatModel.errors?.equalTo">
            {{'SETTINGS_SECURITY_MODAL_CHANGE_PASSWORD_NEW_PASSWORDS_ARE_NOT_EQUAL' | translate}}
          </mat-error>
        </mat-form-field>

        <mat-progress-bar *ngIf="showChangingPasswordSpinner" mode="indeterminate"></mat-progress-bar>

        <button *ngIf="!showChangingPasswordSpinner" [disabled]="!changePasswordForm.form.valid"
                mat-button type="submit">
          {{'NEXT' | translate}}
        </button>
      </form>
    </mat-step>

    <mat-step [editable]="false">
      <ng-template matStepLabel>{{'DONE' | translate}}</ng-template>
      <mat-card class="success-mat-card" matRipple>
        <mat-card-content class="last-child">
          {{'SETTINGS_SECURITY_MODAL_CHANGE_PASSWORD_FINISHED' | translate}}
        </mat-card-content>
      </mat-card>
    </mat-step>
  </mat-vertical-stepper>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>{{'CLOSE' | translate}}</button>
</mat-dialog-actions>
